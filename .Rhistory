id <- c(1:1000)
people <-data.frame(id)
people$ya <- rep(NA, nrow(people))
people$yc <- rep(NA, nrow(people))
people$noschool <- rep(NA, nrow(people))
people$school <- rep(NA, nrow(people))
people$high.wage <- rep(NA, nrow(people))
for (i in 1:nrow(people)){
people$ya[i] <- ya[i]
people$yc[i] <- yc[i]
people$high.wage[i] <- high.wage[i]
people$school[i] <- a.school.val(people$yc[i],people$ya[i],people$high.wage[i] )
people$noschool[i] <- a.noschool.val(people$yc[i],people$ya[i],people$high.wage[i] )
}
warning()
warnings()
warnings
child.mortality <- length(subset(people$yc, yc == 0))/1000
num.school <- length(subset(people$school, school>people$noschool))
num.noschool <- length(subset(people$noschool, people$noschool>people$school))
child.mortality
num.school
num.noschool
# prob = probability of success #
yc <- function(prob.child.death) {
rbinom(1000, 1, prob.child.death)
}
ya <- function(prob.young.death) {
yc * rbinom(1000, 1, prob.young.death)
}
life.expect <- 70
high.wage <- rnorm(1000, mean = 10, sd = 0.5)+0.5
low.wage <- 2
f <- 1
a.school.val <- function(yc, ya, high.wage){
if(yc == 0){
val.school <- 0
}
if(yc == 1 & ya == 0){
val.school <- -f*(year - yc)
}
if(yc == 1 & ya == 1){
val.school <- -f*(ya - yc) + high.wage*(life.expect-ya)
}
return(val.school)
}
a.noschool.val <- function(yc, ya, high.wage){
if(yc == 0){
val.noschool <- 0
}
if(yc == 1 & ya == 0){
val.noschool <- low.wage*(year - yc)
}
if(yc == 1& ya == 1){
val.noschool <- low.wage*(life.expect - yc)
}
return(val.noschool)
}
id <- c(1:1000)
people <-data.frame(id)
people$ya <- rep(NA, nrow(people))
people$yc <- rep(NA, nrow(people))
people$noschool <- rep(NA, nrow(people))
people$school <- rep(NA, nrow(people))
people$high.wage <- rep(NA, nrow(people))
for (i in 1:nrow(people)){
people$ya[i] <- ya(prob.young.death)[i]
people$yc[i] <- yc(prob.young.death)[i]
people$high.wage[i] <- high.wage[i]
people$school[i] <- a.school.val(people$yc[i],people$ya[i],people$high.wage[i] )
people$noschool[i] <- a.noschool.val(people$yc[i],people$ya[i],people$high.wage[i] )
}
ya <- function(prob.young.death,yc) {
yc * rbinom(1000, 1, prob.young.death)
}
life.expect <- 70
high.wage <- rnorm(1000, mean = 10, sd = 0.5)+0.5
low.wage <- 2
f <- 1
a.school.val <- function(yc, ya, high.wage){
if(yc == 0){
val.school <- 0
}
if(yc == 1 & ya == 0){
val.school <- -f*(year - yc)
}
if(yc == 1 & ya == 1){
val.school <- -f*(ya - yc) + high.wage*(life.expect-ya)
}
return(val.school)
}
a.noschool.val <- function(yc, ya, high.wage){
if(yc == 0){
val.noschool <- 0
}
if(yc == 1 & ya == 0){
val.noschool <- low.wage*(year - yc)
}
if(yc == 1& ya == 1){
val.noschool <- low.wage*(life.expect - yc)
}
return(val.noschool)
}
id <- c(1:1000)
people <-data.frame(id)
people$ya <- rep(NA, nrow(people))
people$yc <- rep(NA, nrow(people))
people$noschool <- rep(NA, nrow(people))
people$school <- rep(NA, nrow(people))
people$high.wage <- rep(NA, nrow(people))
for (i in 1:nrow(people)){
people$yc[i] <- yc(prob.young.death)[i]
people$ya[i] <- ya(prob.young.death, people$yc)[i]
people$high.wage[i] <- high.wage[i]
people$school[i] <- a.school.val(people$yc[i],people$ya[i],people$high.wage[i] )
people$noschool[i] <- a.noschool.val(people$yc[i],people$ya[i],people$high.wage[i] )
}
for (i in 1:nrow(people)){
people$yc[i] <- yc(prob.child.death)[i]
people$ya[i] <- ya(prob.young.death, people$yc)[i]
people$high.wage[i] <- high.wage[i]
people$school[i] <- a.school.val(people$yc[i],people$ya[i],people$high.wage[i] )
people$noschool[i] <- a.noschool.val(people$yc[i],people$ya[i],people$high.wage[i] )
}
prob.child.death <- 0.6
prob.young.death <- 0.8
for (i in 1:nrow(people)){
people$yc[i] <- yc(prob.child.death)[i]
people$ya[i] <- ya(prob.young.death, people$yc)[i]
people$high.wage[i] <- high.wage[i]
people$school[i] <- a.school.val(people$yc[i],people$ya[i],people$high.wage[i] )
people$noschool[i] <- a.noschool.val(people$yc[i],people$ya[i],people$high.wage[i] )
}
View(people)
View(people)
warnings()
child.mortality <- function(yc) {
length(subset(yc, yc == 0))/1000
}
child.mortality(0.5)
child.mortality <- function(prob.childdeath) {
length(subset(yc(prob.child.death), yc == 0))/1000
}
child.mortality <- function(prob.childdeath) {
length(subset(people$yc(prob.child.death), yc == 0))/1000
}
child.mortality(0.5)
View(people)
people <-data.frame(id)
people$ya <- rep(NA, nrow(people))
people$yc <- rep(NA, nrow(people))
people$noschool <- rep(NA, nrow(people))
people$school <- rep(NA, nrow(people))
people$high.wage <- rep(NA, nrow(people))
people$life.time <- rep(NA, nrow(people))
for (i in 1:nrow(people)){
people$yc[i] <- yc(prob.child.death)[i]
people$ya[i] <- ya(prob.young.death, people$yc)[i]
people$life.time[i] <- people$yc[i] + people$ya[i]
people$high.wage[i] <- high.wage[i]
people$school[i] <- a.school.val(people$yc[i],people$ya[i],people$high.wage[i] )
people$noschool[i] <- a.noschool.val(people$yc[i],people$ya[i],people$high.wage[i] )
}
View(people)
plot <- qplot(people$life.time, data=school, geom="bar")
people$life.time
plot <- ggplot(people$life.time, data=school) + geom_bar()
plot <- qplot(people$life.time, people$school, geom="bar", stat="identity", fill = I("grey50"))
plot <- qplot(people$life.time, people$school, geom="bar")
plor
plot
plot <- ggplot(people, aes(life.time, school))
plot
plot + geom_point()
plot + geom_bar()
# prob = probability of success #
prob.child.death <- 0.6
prob.young.death <- 0.8
yc <- function(prob.child.death) {
rbinom(1000, 1, prob.child.death)
}
ya <- function(prob.young.death,yc) {
yc * rbinom(1000, 1, prob.young.death)
}
life.expect <- 70
high.wage <- rnorm(1000, mean = 10, sd = 0.5)+0.5
low.wage <- 2
f <- 1
a.school.val <- function(yc, ya, high.wage){
if(yc == 0){
val.school <- 0
}
if(yc == 1 & ya == 0){
val.school <- -f*(year - yc)
}
if(yc == 1 & ya == 1){
val.school <- -f*(ya - yc) + high.wage*(life.expect-ya)
}
return(val.school)
}
a.noschool.val <- function(yc, ya, high.wage){
if(yc == 0){
val.noschool <- 0
}
if(yc == 1 & ya == 0){
val.noschool <- low.wage*(year - yc)
}
if(yc == 1& ya == 1){
val.noschool <- low.wage*(life.expect - yc)
}
return(val.noschool)
}
id <- c(1:1000)
people <-data.frame(id)
people$noschool <- rep(NA, nrow(people))
people$school <- rep(NA, nrow(people))
people$high.wage <- rep(NA, nrow(people))
people$life.time <- rep(NA, nrow(people))
for (i in 1:nrow(people)){
people$life.time[i] <- people$yc[i] + people$ya[i]
people$high.wage[i] <- high.wage[i]
people$school[i] <- a.school.val(yc(prob.child.death)[i],ya(prob.young.death, yc(prob.child.death))[i],people$high.wage[i] )
people$noschool[i] <- a.noschool.val(people$yc[i],people$ya[i],people$high.wage[i] )
}
id <- c(1:1000)
people <-data.frame(id)
people$noschool <- rep(NA, nrow(people))
people$school <- rep(NA, nrow(people))
people$high.wage <- rep(NA, nrow(people))
for (i in 1:nrow(people)){
people$high.wage[i] <- high.wage[i]
people$school[i] <- a.school.val(yc(prob.child.death)[i],ya(prob.young.death, yc(prob.child.death))[i],people$high.wage[i] )
people$noschool[i] <- a.noschool.val(people$yc[i],people$ya[i],people$high.wage[i] )
}
for (i in 1:nrow(people)){
people$high.wage[i] <- high.wage[i]
people$school[i] <- a.school.val(yc(prob.child.death)[i],ya(prob.young.death, (yc(prob.child.death))[i]),people$high.wage[i] )
people$noschool[i] <- a.noschool.val(people$yc[i],people$ya[i],people$high.wage[i] )
}
for (i in 1:nrow(people)){
people$high.wage[i] <- high.wage[i]
people$school[i] <- a.school.val(yc(prob.child.death)[i],ya(prob.young.death, yc(prob.child.death))[i],people$high.wage[i] )
people$noschool[i] <- a.noschool.val(yc(prob.child.death)[i],ya(prob.young.death, yc(prob.child.death)),people$high.wage[i] )
}
warnings()
yc
# prob = probability of success #
prob.child.death <- 0.6
prob.young.death <- 0.8
yc <- function(prob.child.death) {
rbinom(1000, 1, prob.child.death)
}
ya <- function(prob.young.death,yc) {
yc * rbinom(1000, 1, prob.young.death)
}
life.expect <- 70
high.wage <- rnorm(1000, mean = 10, sd = 0.5)+0.5
low.wage <- 2
f <- 1
a.school.val <- function(child, adult, high.wage){
if(child == 0){
val.school <- 0
}
if(child == 1 & adult == 0){
val.school <- -f*(year - yc)
}
if(child == 1 & adult == 1){
val.school <- -f*(ya - yc) + high.wage*(life.expect-ya)
}
return(val.school)
}
a.noschool.val <- function(child, adult, high.wage){
if(child == 0){
val.noschool <- 0
}
if(child  == 1 & adult == 0){
val.noschool <- low.wage*(year - yc)
}
if(child  == 1& adult == 1){
val.noschool <- low.wage*(life.expect - yc)
}
return(val.noschool)
}
id <- c(1:1000)
people <-data.frame(id)
people$noschool <- rep(NA, nrow(people))
people$school <- rep(NA, nrow(people))
people$high.wage <- rep(NA, nrow(people))
for (i in 1:nrow(people)){
people$high.wage[i] <- high.wage[i]
people$school[i] <- a.school.val(yc(prob.child.death)[i],ya(prob.young.death, yc(prob.child.death))[i],people$high.wage[i] )
people$noschool[i] <- a.noschool.val(yc(prob.child.death)[i],ya(prob.young.death, yc(prob.child.death)),people$high.wage[i] )
}
# prob = probability of success #
prob.child.death <- 0.6
prob.young.death <- 0.8
childhood <- 10
life.expect <- 70
yc <- function(prob.child.death) {
rbinom(1000, 1, prob.child.death)
}
ya <- function(prob.young.death,yc) {
yc * rbinom(1000, 1, prob.young.death)
}
life.expect <- 70
high.wage <- rnorm(1000, mean = 10, sd = 0.5)+0.5
low.wage <- 2
f <- 1
a.school.val <- function(child, adult, high.wage){
if(child == 0){
val.school <- 0
}
if(child == 1 & adult == 0){
val.school <- -f*childhood
}
if(child == 1 & adult == 1){
val.school <- -f*childhood + high.wage*(life.expect-childhood)
}
return(val.school)
}
a.noschool.val <- function(child, adult, high.wage){
if(child == 0){
val.noschool <- 0
}
if(child  == 1 & adult == 0){
val.noschool <- low.wage*childhood
}
if(child  == 1& adult == 1){
val.noschool <- low.wage*(life.expect - childhood)
}
return(val.noschool)
}
id <- c(1:1000)
people <-data.frame(id)
people$noschool <- rep(NA, nrow(people))
people$school <- rep(NA, nrow(people))
people$high.wage <- rep(NA, nrow(people))
for (i in 1:nrow(people)){
people$high.wage[i] <- high.wage[i]
people$school[i] <- a.school.val(yc(prob.child.death)[i],ya(prob.young.death, yc(prob.child.death))[i],people$high.wage[i] )
people$noschool[i] <- a.noschool.val(yc(prob.child.death)[i],ya(prob.young.death, yc(prob.child.death)),people$high.wage[i] )
}
warnings()
yc(0.5)
yc(prob.child.death)[1]
View(people)
for (i in 1:nrow(people)){
people$high.wage[i] <- high.wage[i]
people$school[i] <- function(prob.child.death, prob.young.death){
a.school.val(yc(prob.child.death)[i],ya(prob.young.death, yc(prob.child.death))[i],people$high.wage[i] )
}
people$noschool[i] <- a.noschool.val(yc(prob.child.death)[i],ya(prob.young.death, yc(prob.child.death)),people$high.wage[i] )
}
for (i in 1:nrow(people)){
people$yc[i] <- yc(prob.child.death)[i]
people$ya[i] <- ya(prob.young.death, yc(prob.child.death))[i]
people$high.wage[i] <- high.wage[i]
people$school[i] <- a.school.val(yc(prob.child.death)[i],ya(prob.young.death, yc(prob.child.death))[i],people$high.wage[i] )
people$noschool[i] <- a.noschool.val(yc(prob.child.death)[i],ya(prob.young.death, yc(prob.child.death)),people$high.wage[i] )
}
child.mortality <- length(subset(people$yc, yc == 0))/1000
View(people)
people$yc
subsetsubset(people$yc, yc == 0))
subset(people$yc, yc == 0)
for (i in 1:nrow(people)){
people$yc[i] <- yc(prob.child.death)[i]
people$ya[i] <- ya(prob.young.death, people$yc[i])[i]
people$high.wage[i] <- high.wage[i]
people$school[i] <- a.school.val(yc(prob.child.death)[i],ya(prob.young.death, yc(prob.child.death))[i],people$high.wage[i] )
people$noschool[i] <- a.noschool.val(yc(prob.child.death)[i],ya(prob.young.death, yc(prob.child.death)),people$high.wage[i] )
}
num.school <- length(subset(people$school, school>people$noschool))
num.noschool <- length(subset(people$noschool, people$noschool>people$school))
num.noschool <- length(subset(people$noschool, people$noschool>people$school))
child.mortality <- length(subset(people$yc, yc == 0))/1000
threshold = 0
child.mortality <- length(subset(people$yc, yc == 0))/1000
## Question 4.i ##
library(xtable)
set.seed(45)
id <- c(1:10000)
myppl <- data.frame(id )
myppl$group <- rep(NA, nrow(myppl))
myppl$treated <- rep(NA, nrow(myppl))
myppl$nottreated <- rep(NA, nrow(myppl))
myppl$effect <- rep(NA, nrow(myppl))
myppl$takeup <- rep(NA, nrow(myppl))
myppl$outcome <- rep(NA, nrow(myppl))
myppl$treatment <- rep(NA, nrow(myppl))
zero <- c(0.5,1,1.5,2)
one <- c(1.5,2, 2, 2.5)
for (i in 1:nrow(myppl)){
myppl$group[i] <- sample(1:4, 1, replace=TRUE)
myppl$treatment[i] <- sample(0:1, 1, replace=TRUE)
}
for (i in 1:nrow(myppl)){
myppl$treated[i] <- one[myppl$group[i]] + rnorm(1)
myppl$nottreated[i] <- zero[myppl$group[i]] + rnorm(1)
print(as.character(i))
}
for (i in 1:nrow(myppl)){
if (myppl$treatment[i] == 1){
myppl$effect[i] <- myppl$treated[i] - myppl$nottreated[i]
}
print(as.character(i))
}
for (i in 1:nrow(myppl)){
if (myppl$effect[i] > 0.5 & myppl$treatment[i] == 1){
myppl$takeup[i] <- 1
}
if (myppl$effect[i] <= 0.5 & myppl$treatment[i] == 1){
myppl$takeup[i] <- 0
}
print(as.character(i))
}
for (i in 1:nrow(myppl)){
if (myppl$takeup[i] == 1 & myppl$treatment[i] == 1){
myppl$outcome[i] <- myppl$treated[i]
}
else {
myppl$outcome[i] <- myppl$nottreated[i]
}
print(as.character(i))
}
treated.ppl <- subset(myppl, treatment == 1)
not.treated.ppl <- subset(myppl, treatment == 0)
takeupGroup <- c( mean((treated.ppl[(treated.ppl$group == 1),])$takeup),
mean((treated.ppl[(treated.ppl$group == 2),])$takeup),
mean((treated.ppl[(treated.ppl$group == 3),])$takeup),
mean((treated.ppl[(treated.ppl$group == 4),])$takeup))
takeuprates <- data.frame(takeupGroup)
xtable(takeuprates, digits=c(4,4))
numerator <- mean(treated.ppl$outcome) - mean(not.treated.ppl$nottreated)
denominator <- mean(treated.ppl$takeup)
betaIV <- numerator/denominator
ATE <- mean(treated.ppl$treated) - mean(not.treated.ppl$nottreated)
ATET <- mean(treated.ppl$treated) - mean(treated.ppl$nottreated)
ATEN <- mean(not.treated.ppl$treated) - mean(not.treated.ppl$nottreated)
vaccine.mortality <-ggplot(data = gavi00, x = unicefmcv1, y = mortality)
# Data work #
# Covert data from STATA to CSV #
setwd("~/Desktop/data")
library(foreign)
write.table(read.dta('wednesdaypm.dta'), file="output.csv", quote = FALSE, sep = ",")
# Read it into R #
data <- read.csv("output.csv", header = TRUE, row.names=NULL, na.strings=c("","NA"))
library(ggplot2)
# Subsetting by income group #
low <- subset(data, data$low == 1)
high <- subset(data, data$high == 1)
gavi00 <- subset(data, data$gavi_status_00== 1)
no.gavi00 <- subset(data, data$gavi_status_00== 0)
# Plot some things for poor countries #
#gavi00$mean_coverage <- mean(gavi00$unicefmcv1)
vaccine.mortality <-ggplot(data = gavi00, x = unicefmcv1, y = mortality)
vaccine.mortality
vaccine.mortality
asd
#gavi00$mean_coverage <- mean(gavi00$unicefmcv1)
gavi00.year.diff.coverage.mean <-aggregate(gavi00$diff_mcv1coverage, by=list(gavi00$year),
FUN=mean, na.rm=TRUE)
gavi00.mcv1.mean <- ggplot(low.year.diff.coverage.mean, aes(Group.1, x))
gavi00.mcv1.mean + geom_line() + labs(x = "Year", y = "Change in MCV1 coverage (percentage point)") +
ggtitle("Average Annual Change in MCV1 Coverage Over Time \n Low-Income Countries") + theme_bw()
gavi00.year.schoolingM <- aggregate(gavi00$rateofoutofschoolM, by=list(gavi00$year),
FUN=mean, na.rm=TRUE)
gavi00.school <- ggplot(na.omit(gavi00.year.schoolingM), aes(x = Group.1, y = x)) +                    # basic graphical object
geom_line(colour="green") + labs(x = "Year", y = "Rate of Out of School Boys \n of Primary Age (%)") +
ggtitle("Schooling Trends Over Time, Poor Countries") + theme_bw()
gavi00.year.measlescases <- aggregate(gavi00$measles_cases, by=list(gavi00$year),
FUN=mean, na.rm=TRUE)
gavi00.measlescases <- ggplot(na.omit(gavi00.year.measlescases), aes(x = Group.1, y = x)) +                    # basic graphical object
geom_line(colour="green") + labs(x = "Year", y = "Measles Cases (Count)") +
ggtitle("Schooling Trends Over Time, Poor Countries") + theme_bw()
gavi00.year.spending <- na.omit(aggregate(as.numeric(gavi00$vaxspending), by=list(gavi00$year),
FUN=mean, na.rm=TRUE))
gavi00.diff.mort <- ggplot(gavi00, aes(x = diff_mcv1coverage, y = diff_cases)) +                    # basic graphical object
geom_point() + labs(x = "Change in Coverage", y = "Change in Mortality") +
ggtitle("") + theme_bw()
gavi00.year.meanmcv1cov <- aggregate(gavi00$diff_mcv1coverage, by=list(gavi00$year),
FUN=mean, na.rm=TRUE)
# Mean Changes in Coverage by Year, GAVI-supported Countries #
gavi00.diff.cov <- ggplot(gavi00.year.meanmcv1cov, aes(x = Group.1 , y = x)) +                    # basic graphical object
geom_line() + labs(x = "year", y = "diff_mcv1coverage") +
ggtitle("Mean Changes in Coverage by Year") + theme_bw()
gavi00.coverage.mortality <- ggplot(gavi00, aes(x = Group.1, y = x)) +                    # basic graphical object
geom_line(colour="green") + labs(x = "Year", y = "Percentage of Immunization Costs \n Covered by National Government") +
ggtitle("") + theme_bw()
no.gavi00.year.spending <- na.omit(aggregate(no.gavi00$vaxspending, by=list(no.gavi00$year),
FUN=mean, na.rm=TRUE))
no.gavi00.spending <- ggplot(no.gavi00.year.spending, aes(x = Group.1, y = x)) +                    # basic graphical object
geom_line(colour="green") + labs(x = "Year", y = "Percentage of Immunization Costs \n Covered by National Government") +
ggtitle("") + theme_bw()
gavi00.natlbudget <- ggplot(gavi00, aes(na.omit(gavi00$natlbudget)))+
geom_bar(stat = "count")
gavi00.natlbudget
gavi00.natlbudget <- ggplot(gavi00, aes(na.omit(natlbudget)))+
geom_bar(stat = "count")
gavi00.natlbudget
gavi00.natlbudget <- ggplot(gavi00, aes((natlbudget))+
geom_bar(stat = "count")
gavi00.natlbudget <- ggplot(gavi00, aes((natlbudget)))+
geom_bar(stat = "count")
gavi00.natlbudget <- ggplot(gavi00, aes((natlbudget))) + geom_bar(stat = "count")
gavi00.natlbudget
gavi00.natlbudget <- ggplot(gavi00, aes((na.omit(natlbudget))) + geom_bar(stat = "count")
)
gavi00.natlbudget <- ggplot(gavi00, aes((na.omit(natlbudget)))) + geom_bar(stat = "count")
gavi00.natlbudget
vaccine.mortality <-ggplot(data = gavi00, x = unicefmcv1, y = mortality)
vaccine.mortality
